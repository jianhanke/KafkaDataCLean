package com.neuexample.streaming;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerRecord;
import org.apache.kafka.clients.producer.RecordMetadata;

import java.util.Iterator;
import java.util.Properties;
import java.util.Set;

public class MyProducer {

    public static void main(String[] args)throws Exception {

        Properties props = new Properties();
        props.put("bootstrap.servers","hadoop1:6667");
        props.put("acks","all");
        props.put("retries",1);
        props.put("batch.size",16384);  // 单位 byte  约为16k
        props.put("linger.ms",1000);   //
        props.put("buffer.memory", 33554432);//单位 byte  约为32M
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

        KafkaProducer<String, String> producer = new KafkaProducer<String, String>(props);

        String str="{\"maxTemperature\":58,\"driveMotorControllerTemperature\":false,\"dcTemperature\":false,\"controllerDcBusbarCurrent\":10010,\"batteryNumber\":1,\"temperatureDifferential\":false,\"year\":21,\"soc\":59,\"engineFailuresCount\":0,\"insulationResistance\":40877,\"otherFailuresCodes\":[],\"maxVoltageSystemNum\":1,\"seconds\":44,\"driveMotorTemperature\":false,\"minVoltagebatteryNum\":17,\"deviceTypeOverVoltage\":false,\"engineFailuresCodes\":[],\"temperatureProbeCount\":5,\"vin\":\"my_test\",\"highPressureInterlock\":false,\"vehicleFactory\":\"5\",\"driveMotorCount\":1,\"day\":39,\"subsystemVoltageCount\":1,\"gears\":46,\"longitude\":4294967294,\"mileage\":114710,\"socHigh\":false,\"subsystemTemperatureCount\":1,\"level\":0,\"maxTemperatureNum\":1,\"minutes\":23,\"minTemperatureNum\":2,\"batteryCount\":30,\"insulation\":false,\"month\":11,\"deviceFailuresCount\":0,\"socJump\":false,\"subsystemTemperatureDataNum\":1,\"totalVoltage\":983,\"vehicleStatus\":1,\"status\":254,\"deviceFailuresCodes\":[],\"driveMotorFailuresCodes\":[],\"maxVoltagebatteryNum\":9,\"latitude\":4294967294,\"torque\":65534,\"deviceTypeDontMatch\":false,\"socLow\":101,\"alarmInfo\":0,\"cellVoltages\":[1999],\"chargeStatus\":3,\"speed\":65534,\"deviceTypeOverFilling\":false,\"controllerInputVoltage\":960,\"operationMode\":254,\"current\":10031,\"cellCount\":30,\"totalCurrent\":10031,\"minTemperature\":57,\"monomerBatteryUnderVoltage\":false,\"temperature\":254,\"deviceTypeUnderVoltage\":false,\"monomerBatteryOverVoltage\":false,\"batteryConsistencyPoor\":false,\"batteryMaxVoltage\":3281,\"batteryHighTemperature\":false,\"dcStatus\":false,\"hours\":16,\"riveMotorDataNum\":254,\"brakingSystem\":false,\"batteryMinVoltage\":3276,\"minTemperatureSystemNum\":1,\"driveMotorFailuresCount\":0,\"maxTemperatureSystemNum\":1,\"voltage\":983,\"subsystemVoltageDataNum\":1,\"minVoltageSystemNum\":1,\"otherFailuresCount\":0,\"probeTemperatures\":[61],\"time\":1637310245744} ";

        String str2="{\"maxTemperature\":53,\"driveMotorControllerTemperature\":false,\"dcTemperature\":false,\"controllerDcBusbarCurrent\":10000,\"batteryNumber\":1,\"temperatureDifferential\":false,\"year\":21,\"soc\":69,\"engineFailuresCount\":0,\"insulationResistance\":40615000,\"otherFailuresCodes\":[],\"maxVoltageSystemNum\":1,\"seconds\":1,\"driveMotorTemperature\":false,\"minVoltagebatteryNum\":22,\"deviceTypeOverVoltage\":false,\"engineFailuresCodes\":[],\"temperatureProbeCount\":5,\"vin\":\"my_test\",\"highPressureInterlock\":false,\"vehicleFactory\":\"1\",\"driveMotorCount\":1,\"day\":40,\"subsystemVoltageCount\":1,\"gears\":15,\"longitude\":4294967294,\"mileage\":24030,\"socHigh\":false,\"subsystemTemperatureCount\":1,\"level\":0,\"maxTemperatureNum\":5,\"minutes\":17,\"minTemperatureNum\":1,\"batteryCount\":30,\"insulation\":false,\"month\":12,\"deviceFailuresCount\":0,\"socJump\":false,\"subsystemTemperatureDataNum\":1,\"totalVoltage\":1003,\"vehicleStatus\":2,\"status\":254,\"deviceFailuresCodes\":[],\"driveMotorFailuresCodes\":[],\"maxVoltagebatteryNum\":1,\"latitude\":4294967294,\"torque\":65534,\"deviceTypeDontMatch\":false,\"socLow\":false,\"alarmInfo\":0,\"cellVoltages\":[3350,3347,3347,3346,3346,3347,3346,3346,3348,3347,3347,3346,3349,3347,3346,3346,3346,3348,3347,3346,3346,3306,3346,3347,3347,3346,3345,3345,3345,3347],\"chargeStatus\":1,\"speed\":65534,\"deviceTypeOverFilling\":false,\"controllerInputVoltage\":980,\"operationMode\":254,\"current\":9860,\"cellCount\":30,\"totalCurrent\":9860,\"minTemperature\":51,\"monomerBatteryUnderVoltage\":false,\"temperature\":254,\"deviceTypeUnderVoltage\":false,\"monomerBatteryOverVoltage\":false,\"batteryConsistencyPoor\":false,\"batteryMaxVoltage\":3351,\"batteryHighTemperature\":false,\"dcStatus\":false,\"hours\":13,\"riveMotorDataNum\":254,\"brakingSystem\":false,\"batteryMinVoltage\":3306,\"minTemperatureSystemNum\":1,\"driveMotorFailuresCount\":0,\"maxTemperatureSystemNum\":1,\"voltage\":1003,\"subsystemVoltageDataNum\":1,\"minVoltageSystemNum\":1,\"otherFailuresCount\":0,\"probeTemperatures\":[51,52,51,52,53],\"time\":1639980878920}";


        String str3="{\"driveMotorControllerTemperature\":false,\"maxTemperature\":25,\"controllerDcBusbarCurrent\":0,\"dcTemperature\":false,\"batteryNumber\":0,\"temperatureDifferential\":false,\"year\":21,\"soc\":88,\"engineFailuresCount\":0,\"insulationResistance\":3045000,\"otherFailuresCodes\":[],\"maxVoltageSystemNum\":1,\"seconds\":43,\"driveMotorTemperature\":false,\"deviceTypeOverVoltage\":false,\"minVoltagebatteryNum\":67,\"engineFailuresCodes\":[],\"temperatureProbeCount\":34,\"highPressureInterlock\":false,\"vin\":\"my_test\",\"driveMotorCount\":0,\"vehicleFactory\":\"5\",\"day\":36,\"subsystemVoltageCount\":0,\"gears\":0,\"longitude\":0,\"mileage\":134,\"socHigh\":false,\"subsystemTemperatureCount\":0,\"level\":0,\"maxTemperatureNum\":13,\"minutes\":40,\"minTemperatureNum\":1,\"batteryCount\":0,\"insulation\":false,\"month\":12,\"deviceFailuresCount\":0,\"socJump\":false,\"subsystemTemperatureDataNum\":0,\"totalVoltage\":377400,\"status\":0,\"vehicleStatus\":0,\"deviceFailuresCodes\":[],\"driveMotorFailuresCodes\":[],\"maxVoltagebatteryNum\":74,\"latitude\":0,\"torque\":0,\"deviceTypeDontMatch\":false,\"socLow\":false,\"alarmInfo\":0,\"cellVoltages\":\"[3350,3347,3347,3346,3346,3347,3346,3346,3348,3347,3347,3346,3349,3347,3346,3346,3346,3348,3347,3346,3346,3306,3346,3347,3347,3346,3345,3345,3345,3347]\",\"chargeStatus\":3,\"speed\":0,\"controllerInputVoltage\":0,\"deviceTypeOverFilling\":false,\"current\":0,\"operationMode\":0,\"cellCount\":102,\"totalCurrent\":0,\"minTemperature\":25,\"monomerBatteryUnderVoltage\":false,\"temperature\":25,\"deviceTypeUnderVoltage\":false,\"monomerBatteryOverVoltage\":false,\"batteryConsistencyPoor\":false,\"batteryHighTemperature\":false,\"batteryMaxVoltage\":3700,\"dcStatus\":false,\"hours\":17,\"riveMotorDataNum\":0,\"brakingSystem\":false,\"batteryMinVoltage\":3700,\"minTemperatureSystemNum\":1,\"driveMotorFailuresCount\":0,\"maxTemperatureSystemNum\":1,\"voltage\":377400,\"subsystemVoltageDataNum\":0,\"minVoltageSystemNum\":1,\"otherFailuresCount\":0,\"probeTemperatures\":\"[51,52,51,52,53]\",\"time\":1639993243000}";


        String str4="{\"driveMotorControllerTemperature\":false,\"maxTemperature\":49,\"controllerDcBusbarCurrent\":0,\"dcTemperature\":false,\"batteryNumber\":0,\"temperatureDifferential\":false,\"year\":21,\"soc\":69,\"engineFailuresCount\":0,\"insulationResistance\":3018000,\"otherFailuresCodes\":[],\"maxVoltageSystemNum\":1,\"seconds\":50,\"driveMotorTemperature\":false,\"deviceTypeOverVoltage\":false,\"minVoltagebatteryNum\":61,\"engineFailuresCodes\":[],\"temperatureProbeCount\":34,\"highPressureInterlock\":false,\"vin\":\"my_test\",\"driveMotorCount\":0,\"vehicleFactory\":\"5\",\"day\":23,\"subsystemVoltageCount\":0,\"gears\":0,\"longitude\":0,\"mileage\":302,\"socHigh\":false,\"subsystemTemperatureCount\":0,\"level\":0,\"maxTemperatureNum\":1,\"minutes\":15,\"minTemperatureNum\":1,\"batteryCount\":0,\"insulation\":false,\"month\":12,\"deviceFailuresCount\":0,\"socJump\":false,\"subsystemTemperatureDataNum\":0,\"totalVoltage\":0,\"status\":0,\"vehicleStatus\":0,\"deviceFailuresCodes\":[],\"driveMotorFailuresCodes\":[],\"maxVoltagebatteryNum\":29,\"latitude\":0,\"torque\":0,\"deviceTypeDontMatch\":false,\"socLow\":false,\"alarmInfo\":0,\"cellVoltages\":[3893,3894,3894,3894,3892,3894,3894,3894,3893,3893,3893,3893,3895,3894,3896,3895,3895,3894,3895,3894,3895,3895,3893,3894,3896,3896,3895,3895,3897,3896,3896,3894,3894,3896,3893,3895,3892,3893,3894,3894,3895,3895,3894,3894,3895,3896,3894,3894,3893,3893,3895,3893,3893,3893,3892,3894,3894,3892,3894,3894,3890,3891,3894,3893,3893,3894,3894,3894,3893,3892,3893,3894,3893,3893,3893,3893,3893,3894,3893,3894,3894,3892,3891,3893,3893,3893,3893,3893,3893,3893,3893,3893,3893,3893,3893,3894,3893,3893,3893,3893,3893,3891],\"chargeStatus\":3,\"speed\":0,\"controllerInputVoltage\":0,\"deviceTypeOverFilling\":false,\"current\":0,\"operationMode\":0,\"cellCount\":102,\"totalCurrent\":0,\"minTemperature\":49,\"monomerBatteryUnderVoltage\":false,\"temperature\":0,\"deviceTypeUnderVoltage\":false,\"monomerBatteryOverVoltage\":false,\"batteryConsistencyPoor\":false,\"batteryHighTemperature\":false,\"batteryMaxVoltage\":3897,\"dcStatus\":false,\"hours\":14,\"riveMotorDataNum\":0,\"brakingSystem\":false,\"batteryMinVoltage\":3890,\"minTemperatureSystemNum\":1,\"driveMotorFailuresCount\":0,\"maxTemperatureSystemNum\":1,\"voltage\":3971,\"subsystemVoltageDataNum\":0,\"minVoltageSystemNum\":1,\"otherFailuresCount\":0,\"probeTemperatures\":[49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49],\"time\":1640240150000}";

        RecordMetadata meta = producer.send(new ProducerRecord<String, String>("vehicledwd", str4)).get();

        System.out.println("offset:"+meta.offset()+","+meta.toString());

        producer.close();

    }

}
